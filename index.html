<script>
function send() {
  const fileInput = document.getElementById("file");
  const file = fileInput.files[0];
  if (!file) {
    alert("ç”»åƒã‚’é¸ã‚“ã§ã­");
    return;
  }

  const reader = new FileReader();
  reader.onload = () => {
    document.getElementById("preview").src = reader.result;
    document.getElementById("preview").style.display = "block";

    const score = Math.floor(70 + Math.random() * 25);
    const rank = score >= 90 ? "S" : score >= 80 ? "A" : "B";

    document.getElementById("result").innerHTML = `
      <b>è¨ºæ–­çµæœ</b><br>
      é»„é‡‘æ¯”ï¼š${score}%<br>
      ãƒ©ãƒ³ã‚¯ï¼š${rank}
    `;

    // ğŸ”¥ å¤±æ•—ã—ã¦ã‚‚ç”»é¢ãŒæ­»ãªãªã„
    fetch("/.netlify/functions/send", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ score, rank })
    }).catch(err => {
      console.error("send error", err);
    });
  };

  reader.readAsDataURL(file);
}
</script>
